# PRV_KEY for master sender 0x01501aD68D809ED61D514A4080630Ba51e5B493C
PRV_KEY=1431519913bc0e303418a8f7c7fdfd4268039eda2d413c884ce5a1d498a4d5a2
GAS_PRICE=$(cast gas-price --rpc-url $RPC_URL)

echo "Test extCodeHashOfDeletedAccount (src/BlockchainTestsFiller/ValidBlocks/bcStateTests/extCodeHashOfDeletedAccountFiller.json)"

AMOUNT=$((2*150000*3*$GAS_PRICE+0))
echo "[extCodeHashOfDeletedAccount] Funding sender 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0x3f95270a42838C46Ec263ae5b92433B94B3F56eB) with $AMOUNT"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --value $AMOUNT 0x3f95270a42838C46Ec263ae5b92433B94B3F56eB | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

echo "[extCodeHashOfDeletedAccount] Creating receiver 0x1000000000000000000000000000000000000000 with code and balance 1000..."
ADDR_1000000000000000000000000000000000000000=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1000 --create 6300000055601260003963000000556000F37320000000000000000000000000000000000000003f6000557320000000000000000000000000000000000000003b6001556020600060007320000000000000000000000000000000000000003c60005160025500 | jq -r .contractAddress)
echo $ADDR_1000000000000000000000000000000000000000

echo "[extCodeHashOfDeletedAccount] Creating receiver 0x1100000000000000000000000000000000000000 with code and balance 1000..."
ADDR_1100000000000000000000000000000000000000=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1000 --create 6300000025601260003963000000256000F360006000600060006000732000000000000000000000000000000000000000620186a0f100 | jq -r .contractAddress)
echo $ADDR_1100000000000000000000000000000000000000

echo "[extCodeHashOfDeletedAccount] Creating receiver 0x1200000000000000000000000000000000000000 with code and balance 1000..."
ADDR_1200000000000000000000000000000000000000=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1000 --create 6300000055601260003963000000556000F37320000000000000000000000000000000000000003f6000557320000000000000000000000000000000000000003b6001556020600060007320000000000000000000000000000000000000003c60005160025500 | jq -r .contractAddress)
echo $ADDR_1200000000000000000000000000000000000000

echo "[extCodeHashOfDeletedAccount] Creating receiver 0x2000000000000000000000000000000000000000 with code and balance 1000..."
ADDR_2000000000000000000000000000000000000000=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1000 --create 6300000004601260003963000000046000F36001ff00 | jq -r .contractAddress)
echo $ADDR_2000000000000000000000000000000000000000

echo "[extCodeHashOfDeletedAccount] Processing transaction number 775 from 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0x3f95270a42838C46Ec263ae5b92433B94B3F56eB) to 0x1000000000000000000000000000000000000000"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key e68a5a55980489fe45e4c9adaf09b498657bb8d3d01b5927b0df8335385a13b0 --timeout 20 --value 0 $ADDR_1000000000000000000000000000000000000000 | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

echo "[extCodeHashOfDeletedAccount] Processing transaction number 776 from 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0x3f95270a42838C46Ec263ae5b92433B94B3F56eB) to 0x1100000000000000000000000000000000000000"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key e68a5a55980489fe45e4c9adaf09b498657bb8d3d01b5927b0df8335385a13b0 --timeout 20 --value 0 $ADDR_1100000000000000000000000000000000000000 | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

echo "[extCodeHashOfDeletedAccount] Processing transaction number 777 from 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0x3f95270a42838C46Ec263ae5b92433B94B3F56eB) to 0x1200000000000000000000000000000000000000"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key e68a5a55980489fe45e4c9adaf09b498657bb8d3d01b5927b0df8335385a13b0 --timeout 20 --value 0 $ADDR_1200000000000000000000000000000000000000 | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

