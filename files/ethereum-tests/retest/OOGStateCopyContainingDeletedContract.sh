# PRV_KEY for master sender 0x1AAeb605b308160CCcF97B895b490c7B22444876
PRV_KEY=aff8216366389e7760817983b7064deece97e0dcfb682fc77d2a6e7d35c1cfba
GAS_PRICE=$(cast gas-price --rpc-url $RPC_URL)

echo "Test OOGStateCopyContainingDeletedContract (src/BlockchainTestsFiller/ValidBlocks/bcStateTests/OOGStateCopyContainingDeletedContractFiller.json)"

AMOUNT=$((2*150000*2*$GAS_PRICE+1003))
echo "[OOGStateCopyContainingDeletedContract] Funding sender 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0xA75B3143396D6EB5f6E9e42B6A78D1830a9017EA) with $AMOUNT"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --value $AMOUNT 0xA75B3143396D6EB5f6E9e42B6A78D1830a9017EA | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

echo "[OOGStateCopyContainingDeletedContract] Creating receiver 0x2e0de3fc10a88911ff857126db1a5f0da6f25173 with code and balance 1..."
ADDR_2E0DE3FC10A88911FF857126DB1A5F0DA6F25173=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1 --create 63000001fc601260003963000001fc6000F360606040526000357c01000000000000000000000000000000000000000000000000000000009004806342e90c3314610044578063fc49c80e1461005157610042565b005b61004f600450610064565b005b6100626004803590602001506100a4565b005b6000600090505b600a8160ff1610156100a057602a600060005082600a81101561000257909001600050819055505b808060010191505061006b565b5b50565b3073ffffffffffffffffffffffffffffffffffffffff1661ea6060405180807f53746f7265282900000000000000000000000000000000000000000000000000815260200150600701905060405180910390207c0100000000000000000000000000000000000000000000000000000000809104027c0100000000000000000000000000000000000000000000000000000000900490604051827c010000000000000000000000000000000000000000000000000000000002815260040180905060006040518083038160008887f19350505050508073ffffffffffffffffffffffffffffffffffffffff166326c6a34c604051817c01000000000000000000000000000000000000000000000000000000000281526004018090506020604051808303816000876161da5a03f115610002575050506040515160006000506009600a81101561000257909001600050819055505b5056 | jq -r .contractAddress)
echo $ADDR_2E0DE3FC10A88911FF857126DB1A5F0DA6F25173

echo "[OOGStateCopyContainingDeletedContract] Creating receiver 0x64306ec3f51a26dcf19f5da0c043040f54f4eca5 with code and balance 1..."
ADDR_64306EC3F51A26DCF19F5DA0C043040F54F4ECA5=$(cast send --json --legacy --rpc-url $RPC_URL --private-key $PRV_KEY --timeout 20 --value 1 --create 6300000094601260003963000000946000F360606040526000357c0100000000000000000000000000000000000000000000000000000000900480630c5feb5d14604157806326c6a34c14604c57603f565b005b604a600450606b565b005b60556004506086565b6040518082815260200191505060405180910390f35b3373ffffffffffffffffffffffffffffffffffffffff16ff5b565b600061053990506091565b9056 | jq -r .contractAddress)
echo $ADDR_64306EC3F51A26DCF19F5DA0C043040F54F4ECA5

echo "[OOGStateCopyContainingDeletedContract] Processing transaction number 732 from 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0xA75B3143396D6EB5f6E9e42B6A78D1830a9017EA) to 0x64306ec3f51a26dcf19f5da0c043040f54f4eca5"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key 55de382dc78a4ccc06dce1721bcd37b1a5282ac055a2d71a3b30cccc7fa59304 --timeout 20 --value 1 $ADDR_64306EC3F51A26DCF19F5DA0C043040F54F4ECA5 0x0c5feb5d | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

echo "[OOGStateCopyContainingDeletedContract] Processing transaction number 733 from 0xa94f5374Fce5edBC8E2a8697C15331677e6EbF0B(remapped to 0xA75B3143396D6EB5f6E9e42B6A78D1830a9017EA) to 0x2e0de3fc10a88911ff857126db1a5f0da6f25173"...
STATUS=$(cast send --json --legacy --rpc-url $RPC_URL --private-key 55de382dc78a4ccc06dce1721bcd37b1a5282ac055a2d71a3b30cccc7fa59304 --timeout 20 --value 1002 $ADDR_2E0DE3FC10A88911FF857126DB1A5F0DA6F25173 0xfc49c80e00000000000000000000000064306ec3f51a26dcf19f5da0c043040f54f4eca5 | jq -r .status)
if [ "$STATUS" == "0x1" ]; then echo "Success"; else echo "FAIL"; fi

